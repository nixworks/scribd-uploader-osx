<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
	"http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
	<head>
		<title>Scribd Uploader source code overview</title>
		<meta name="keywords" content="source code, developer" />
		<meta name="project" content="Scribd Uploader Help" />
		<meta name="description" content="An overview of the Scribd Uploader codebase." />
    <link href="../sty/layout.css" rel="stylesheet" type="text/css" />
    <link href="../sty/typography.css" rel="stylesheet" type="text/css" />
    <link href="../sty/print.css" rel="stylesheet" type="text/css" media="print" />
	</head>

	<body class="en">
		<div id="Nav">
			<a id="code_overview" />
			<div id="NavLeft"><a class="NavLinkLeft" href="help:anchor='access' bookID=Scribd Uploader Help">Home</a></div>
			<!-- div id="NavRight"><a class="NavLinkRight" href="help:anchor='index' bookID=Scribd Uploader Help">Index</a></div -->
		</div>
		
		<div class="AppleTopic">
			<div class="Section">
				<div id="Header">
					<div id="Icon"><img id="iconimg" src="../gfx/icon32.png" alt="Scribd Uploader icon" height="32" width="32" /></div>
					<div class="Name">Scribd Uploader source code overview</div>
				</div>
				<div class="AppleTopicBody">
					<div class="Intro">
						<p class="Para">Scribd Uploader for Mac OS X is a fully Cocoa-native application developed in Objective-C. Scribd Uploader uses the following Cocoa technologies:</p>
						<ul class="ListDescriptor">
							<li>
								<div class="Term">Core Data:  </div>
								<div class="Description">The upload queue is stored using the Core Data API. Each file in the queue is an <tt>NSManagedObject</tt> entity.</div>
							</li>
							<li>
								<div class="Term">Cocoa Bindings:  </div>
								<div class="Description">Model objects are all Key-Value Coding compliant, and view controls almost always have their attributes set via Cocoa Bindings.</div>
							</li>
							<li>
								<div class="Term">Drag and Drop:  </div>
								<div class="Description">The file list view has been subclassed to add Cocoa drag-and-drop support for adding files.</div>
							</li>
							<li>
								<div class="Term">Quick Look:  </div>
								<div class="Description">Though the Quick Look API is unpublished and undocumented by Apple, Scribd Uploader makes use of it to integrate Quick Look support in the file list.</div>
							</li>
						</ul>
						<p class="Para">To communicate with the Scribd website, Scribd Uploader uses the <a href="http://www.scribd.com/publisher/api">Scribd Platform API</a>. This API allows any program or library to work with the Scribd website. A program can create accounts, log in, upload and modify files, and more using standard HTTP calls.</p>
						<p class="Para">Scribd Uploader uses <a href="http://allseeing-i.com/ASIHTTPRequest">ASIHTTPRequest</a> to send and receive data from the Scribd.com website. <tt>ASIHTTPRequest</tt> is an improvement upon <tt>NSHTTPRequest</tt> that better supports <tt>POST</tt>ing large form data fields.</p>
						<p class="Para">To perform automatic updates, Scribd uses <a href="http://sparkle.andymatuschak.org/">Sparkle</a>. Be aware that Sparkle&rsquo;s classes use the same prefix as the Scribd Uploader (&ldquo;SU&rdquo;), which can lead to confusion. The preferences window is handled by <a href="http://www.mere-mortal-software.com/blog/details.php?d=2007-03-11">DBPreferencesWindow</a>.</p>
						
						<h2>Documentation</h2>
						<p class="Para">All public classes and methods in the Scribd Uploader codebase are documented comprehensively using the <a href="http://developer.apple.com/opensource/tools/headerdoc.html">HeaderDoc</a> format. The best way to understand a class's purpose and functionality is to read its &ldquo;.h&rdquo; file, which contains HeaderDoc documentation for the class and its public methods. Documentation for private methods or overridden methods, should you need it, is available in the &ldquo;.m&rdquo; file for the class, in basic C block comment syntax.</p>
						
						<h2>Descriptive Overview</h2>
						<p class="Para">The first responder for most application events is <strong><tt>SUAppDelegate</tt></strong>. This class handles button-click events for the primary user interface buttons. If a file is added using the Add File&hellip; button, the <tt>addFile:</tt> method is called. Drag-and-drop adding of files, however, is handled by the <strong><tt>SUDocumentArrayController</tt></strong> class. This subclass of <tt>NSArrayController</tt> is the drag-and-drop delegate for the file list view.</p>
						<p class="Para">Files in the queue are <strong><tt>SUDocument</tt></strong> Core Data entities. Core Data objects (the managed object context and model, for instance) are accessible via the <strong><tt>SUDatabaseHelper</tt></strong> nib object. The <strong><tt>SUDocumentHelper</tt></strong> singleton class includes utility methods that work with the data store (such as finding all completed documents). When the application first starts, <tt>SUDatabaseHelper</tt> checks if any files in the queue have been moved or deleted since the last launch. If so, it then removes those files from the queue and displays an alert using <strong><tt>SUFileNotFoundAlertDelegate</tt></strong>.</p>
						<p class="Para">The file list view is a subclassed <tt>NSScrollView</tt> called <strong><tt>SUFileListView</tt></strong>. The subclass listens for space bar keypress events and displays the Quick Look pane. Quick Look is handled by the <strong><tt>SUQuickLookDelegate</tt></strong>.</p>
						<p class="Para">If the user presses the Log In/Switch Users button (or if he presses the Upload button without first having logged in), the login/signup pane is shown. This pane's events are processed by the <strong><tt>SULoginSheetDelegate</tt></strong>. This delegate receives Log In or Sign Up button clicks, performs the action, and handles the user interface response for the result (whether successful or not).</p>
						<p class="Para">The login sheet delegate does this by making calls to <strong><tt>SUUploadHelper</tt></strong>, which performs signup, login, and upload tasks using information in the view. The actual HTTP calls to the Scribd.com website are performed by <strong><tt>SUScribdAPI</tt></strong>. If the API returns an error, the <strong><tt>SUAdditions</tt></strong> category adds a method to <tt>NSError</tt> which populates it with API error information.</p>
						<p class="Para">If a login is successful, the <strong><tt>SUSessionHelper</tt></strong> singleton stores the Scribd.com session key in the user defaults, so that the login step can be skipped for future uploads.</p>
						<p class="Para">When the upload is underway, <tt>SUUploadHelper</tt> creates a <strong><tt>SUUploadDelegate</tt></strong> instance for each file that is being uploaded. This delegate responds to <tt>ASIHTTPRequest</tt> events, updating the <tt>SUDocument</tt>'s attributes (which are bound to view objects). If an error occurs, the upload delegate serializes the <tt>NSError</tt> and stores it in the <tt>SUDocument</tt> entity's <tt>error</tt> property.</p>
						<p class="Para">Files that error have small error widgets displayed next to them. These widgets are <tt>NSButton</tt>s that, when clicked, use <strong><tt>SUUploadErrorController</tt></strong> to display a sheet with information about the error. To facilitate binding the icon for this button to the error state for the file, the table column is subclassed as <strong><tt>SUTableStatusColumn</tt></strong>.</p>
						<p class="Para">When a batch upload is complete, a sheet is displayed giving the user a chance to visit the Scribd.com website and edit the newly uploaded documents. This sheet&rsquo;s events are handled by <tt>SUUploadCompleteSheetDelegate</tt>, which builds the Scribd.com URL to visit, among other tasks.</p>
						<p class="Para">The About window also has its own delegate, mainly for showing a relevant help page when the &ldquo;?&rdquo; button is clicked; it is <strong><tt>SUAboutWindowDelegate</tt></strong>.</p>
						<p class="Para">The Preferences window is defined and managed in a separate xib file, Preferences.xib, whose owner is a nib-instanced <strong><tt>SUPreferencesWindowController</tt></strong>, which handles events from the Preferences window.</p>
						
						<table type="Multicolumn" cols="2" border="0" cellspacing="2" cellpadding="2">
							<tr class="TableHead">
								<th>
									<div class="TableHead">To learn about</div>
								</th>
								<th>
									<div class="TableHead">Go to</div>
								</th>
							</tr>
							<tr>
								<td>
									<p class="Para">How to contribute to the Scribd Uploader project</p>
								</td>
								<td>
									<p class="Para"><a href="help:anchor='edit_code' bookID=Scribd Uploader Help">Add to or modify the code for Scribd Uploader</a></p>
									<p class="Para"><a href="help:anchor='redistribution_license' bookID=Scribd Uploader Help">View the license for redistributing modified copies of Scribd Uploader</a></p>
								</td>
							</tr>
							<tr>
								<td>
									<p class="Para">The Scribd Uploader project home page</p>
								</td>
								<td>
									<p class="Para"><a href="http://github.com/RISCfuture/scribd-uploader">Scribd Uploader developer project site</a></p>
								</td>
							</tr>
						</table>
					</div>
				</div>
			</div>
		</div>
	</body>
</html>
